{% extends layout %}
{% block title %} Items {% endblock %}
{% block header %} 
	<h1> 
		{% if category is defined %} {{ category.name }} > 
		{% elseif channel is defined %} {{ channel.title }} >
		{% endif %}
		Items 
	</h1>
 {% endblock %}
{% block content %}
	<table id="itemsTable" class="table table-striped table-hover"><thead>
	    <tr>
	      <th width="20%">Channel</th>
	      <th>Title</th>
	    </tr>
	</thead><tbody>
{% for i in items %}
	<tr id="item-summary-{{i.id}}" data-viewed="{{i.viewed}}" data-id="{{i.id}}" class="summary {% if not i.viewed %} new {% else %} old {% endif %}" >
		<td> {{ i.channel.title }} </td>
		<td> {{ i.title }} </td>
	</tr>
	<tr id="item-{{i.id}}" data-id="{{i.id}}" class="details"><td colspan="2"> 
		<h3>{{ i.title }}</h3>
		<div> {{ i.content }} </div>
		<a href="{{i.link}}" class="pull-right btn btn-success"> Visit </a>
		<div class="clearfix"></div>
	</td></tr>
{% endfor %}
	</tbody></table>
<script>
	var id = false;
	$('#itemsTable tbody tr.summary').click(function(){
		id = $(this).attr('data-id');
		var viewed = $('#item-summary-'+id).attr('data-viewed');
		if( '0' == viewed ){
			console.log('Update item ' + id);
		}
		$('#item-'+id).toggle();
		$('#item-summary-'+id).removeClass('new').addClass('old');
	});
</script>
{% endblock %}